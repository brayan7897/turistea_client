<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Test de Direcci√≥n - PlaceCard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .test-container { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0; }
        .step { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border-left: 4px solid #007bff; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .success { border-left-color: #28a745; background: #d4edda; }
        .warning { border-left-color: #ffc107; background: #fff3cd; }
        code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-family: monospace; }
        .highlight { background: yellow; font-weight: bold; }
        .console-output { background: #1e1e1e; color: #fff; padding: 15px; border-radius: 5px; font-family: monospace; white-space: pre-wrap; }
        .emoji { font-size: 1.2em; }
        .browser-instruction { background: #e3f2fd; padding: 15px; border-radius: 5px; border: 1px solid #2196f3; }
    </style>
</head>
<body>
    <h1>üß™ Test de Direcci√≥n - PlaceCard Debug</h1>

    <div class="browser-instruction">
        <h2>üìã Instrucciones para el Test</h2>
        <ol>
            <li><strong>Abrir la aplicaci√≥n:</strong> Ve a <a href="http://localhost:3001" target="_blank">http://localhost:3001</a></li>
            <li><strong>Abrir Consola:</strong> Presiona <code>F12</code> para abrir las herramientas de desarrollo</li>
            <li><strong>Ir a la pesta√±a "Console"</strong></li>
            <li><strong>Escribir en el chat:</strong> <span class="highlight">"¬øQu√© lugares tur√≠sticos hay en Hu√°nuco?"</span></li>
            <li><strong>Enviar mensaje</strong> y esperar respuesta</li>
            <li><strong>Revisar logs</strong> en la consola seg√∫n la tabla de abajo</li>
        </ol>
    </div>

    <div class="test-container">
        <h2>üîç Logs de Debug Esperados (en orden)</h2>
        
        <div class="step">
            <h3>1Ô∏è‚É£ Entrada al touristPlacesService</h3>
            <div class="console-output">üèõÔ∏è [DEBUG] generateCardsFromResponse input: "¬øQu√© lugares tur√≠sticos hay en Hu√°nuco?"</div>
            <p><strong>Qu√© verificar:</strong> La consulta se est√° procesando correctamente</p>
        </div>

        <div class="step">
            <h3>2Ô∏è‚É£ Lugares encontrados</h3>
            <div class="console-output">üèõÔ∏è [DEBUG] extractTouristPlaces final result: [
  {
    "key": "kotosh", 
    "title": "Complejo Arqueol√≥gico de Kotosh",
    "location": "Km 5 Oeste, Hu√°nuco",
    ...
  }
]</div>
            <p><strong>Qu√© verificar:</strong> <span class="highlight">location: "Km 5 Oeste, Hu√°nuco"</span> debe estar presente</p>
        </div>

        <div class="step">
            <h3>3Ô∏è‚É£ Direcciones extra√≠das</h3>
            <div class="console-output">üìç [DEBUG] Direcciones extra√≠das: ["Km 5 Oeste, Hu√°nuco", "Jr. Dos de Mayo, Hu√°nuco"]</div>
            <p><strong>Qu√© verificar:</strong> Las direcciones est√°n siendo extra√≠das del JSON</p>
        </div>

        <div class="step">
            <h3>4Ô∏è‚É£ Conversi√≥n a formato card (CR√çTICO)</h3>
            <div class="console-output">üèõÔ∏è [DEBUG] touristPlacesService.placeToCardFormat input: {
  "title": "Complejo Arqueol√≥gico de Kotosh",
  "location": "Km 5 Oeste, Hu√°nuco",
  ...
}</div>
            <p><strong>Qu√© verificar:</strong> <span class="highlight">location</span> debe tener la direcci√≥n correcta</p>
        </div>

        <div class="step">
            <h3>5Ô∏è‚É£ Mapeo de direcci√≥n espec√≠fico (CR√çTICO)</h3>
            <div class="console-output">üìç [DEBUG] Direcci√≥n espec√≠fica: {
  "original_direccion": "Km 5 Oeste, Hu√°nuco",
  "mapped_buttonUrl": "Km 5 Oeste, Hu√°nuco"
}</div>
            <p><strong>Qu√© verificar:</strong> Ambos valores deben ser iguales y no estar vac√≠os</p>
        </div>

        <div class="step">
            <h3>6Ô∏è‚É£ Resultado del formateo</h3>
            <div class="console-output">üèõÔ∏è [DEBUG] touristPlacesService.placeToCardFormat output: {
  "structValue": {
    "fields": {
      "buttonUrl": { "stringValue": "Km 5 Oeste, Hu√°nuco" },
      ...
    }
  }
}</div>
            <p><strong>Qu√© verificar:</strong> <span class="highlight">buttonUrl.stringValue</span> debe tener la direcci√≥n</p>
        </div>

        <div class="step">
            <h3>7Ô∏è‚É£ Datos formateados para PlaceCard</h3>
            <div class="console-output">üèõÔ∏è [DEBUG] Datos formateados para PlaceCard: [
  {
    "title": { "stringValue": "Complejo Arqueol√≥gico de Kotosh" },
    "buttonUrl": { "stringValue": "Km 5 Oeste, Hu√°nuco" },
    ...
  }
]</div>
            <p><strong>Qu√© verificar:</strong> <span class="highlight">buttonUrl.stringValue</span> debe contener la direcci√≥n</p>
        </div>

        <div class="step">
            <h3>8Ô∏è‚É£ Extracci√≥n en PlaceCard (FINAL)</h3>
            <div class="console-output">üîç [DEBUG] Todos los datos extra√≠dos del card: {
  "title": "Complejo Arqueol√≥gico de Kotosh",
  "buttonText": "Km 5 Oeste, Hu√°nuco",
  ...
}</div>
            <p><strong>Qu√© verificar:</strong> <span class="highlight">buttonText</span> debe tener la direcci√≥n final</p>
        </div>

        <div class="step">
            <h3>9Ô∏è‚É£ Debug espec√≠fico de ubicaci√≥n</h3>
            <div class="console-output">üìç [DEBUG] Ubicaci√≥n en PlaceCard: {
  "raw_buttonUrl": { "stringValue": "Km 5 Oeste, Hu√°nuco" },
  "final_buttonText": "Km 5 Oeste, Hu√°nuco"
}</div>
            <p><strong>Qu√© verificar:</strong> <span class="highlight">final_buttonText</span> debe tener la direcci√≥n y mostrarla en el card</p>
        </div>
    </div>

    <!-- DIAGN√ìSTICO SEG√öN RESULTADOS -->
    <div class="error">
        <h2>üö® Diagn√≥stico seg√∫n resultados del test</h2>
        
        <h3>Si el paso 2 falla (extractTouristPlaces vac√≠o):</h3>
        <ul>
            <li><strong>Problema:</strong> No se encuentran lugares por keywords</li>
            <li><strong>Soluci√≥n:</strong> Verificar que "hu√°nuco" o "lugares tur√≠sticos" activen la b√∫squeda</li>
        </ul>
        
        <h3>Si el paso 3 falla (sin direcciones):</h3>
        <ul>
            <li><strong>Problema:</strong> buildPlacesDatabase() no mapea place.direccion correctamente</li>
            <li><strong>Soluci√≥n:</strong> Error en la l√≠nea 14 del servicio</li>
        </ul>
        
        <h3>Si el paso 5 falla (direcciones vac√≠as):</h3>
        <ul>
            <li><strong>Problema:</strong> place.location est√° undefined en placeToCardFormat</li>
            <li><strong>Soluci√≥n:</strong> Verificar que extractTouristPlaces retorna location</li>
        </ul>
        
        <h3>Si el paso 7 falla (buttonUrl vac√≠o):</h3>
        <ul>
            <li><strong>Problema:</strong> DynamicListCards no pasa correctamente los datos</li>
            <li><strong>Soluci√≥n:</strong> Verificar formatDataForCard en DynamicListCards.js</li>
        </ul>
        
        <h3>Si el paso 9 falla (buttonText vac√≠o):</h3>
        <ul>
            <li><strong>Problema:</strong> PlaceCard no extrae card.buttonUrl?.stringValue correctamente</li>
            <li><strong>Soluci√≥n:</strong> Error en la extracci√≥n en PlaceCard.js l√≠nea donde extrae buttonText</li>
        </ul>
    </div>

    <div class="success">
        <h2>‚úÖ Resultado Esperado</h2>
        <p>Si todo funciona correctamente, el PlaceCard debe mostrar:</p>
        <ul>
            <li><strong>T√≠tulo:</strong> "Complejo Arqueol√≥gico de Kotosh"</li>
            <li><strong>Ubicaci√≥n:</strong> "üìç Km 5 Oeste, Hu√°nuco" (no "Direcci√≥n no disponible")</li>
            <li><strong>Descripci√≥n en modal:</strong> Texto completo del JSON</li>
            <li><strong>Bot√≥n de ubicaci√≥n funcional</strong></li>
        </ul>
    </div>

    <div class="warning">
        <h2>üìû Reportar Resultados</h2>
        <p>Despu√©s de hacer la prueba, informa:</p>
        <ol>
            <li><strong>¬øEn qu√© paso se detiene o falla?</strong></li>
            <li><strong>¬øQu√© logs espec√≠ficos ves en la consola?</strong></li>
            <li><strong>¬øSigue mostrando "Direcci√≥n no disponible"?</strong></li>
            <li><strong>Screenshot del card si es posible</strong></li>
        </ol>
        <p><em>Con esta informaci√≥n podr√© identificar el problema exacto y solucionarlo.</em></p>
    </div>

</body>
</html>
